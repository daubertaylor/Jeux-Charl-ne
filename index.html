<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Flappy Heart - Pour Charlène ❤️</title>
    <style>
        body { margin: 0; overflow: hidden; background-color: #87CEEB; touch-action: none; } /* Ciel bleu clair, désactiver zoom/pinch */
        canvas { display: block; width: 100%; height: 100vh; }
    </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        // Adapter la taille du canvas à l'écran (pour mobile)
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        // Variables du jeu (adaptées pour mobile)
        let gravity = 0.6;
        let jump = -12;
        let playerY = canvas.height / 2;
        let playerVelocity = 0;
        let obstacles = [];
        let score = 0;
        let gameOver = false;
        let gameStarted = false;
        let frame = 0;
        let obstacleFrequency = 120;
        let heartSize = 25;

        // Dessiner le cœur en style cartoon détaillé (yeux, bouche, animation bouncy, ombre)
        function drawHeart(x, y, size) {
            // Ombre pour profondeur
            ctx.beginPath();
            ctx.ellipse(x + 5, y + size * 2 + 5, size * 1.2, size / 4, 0, 0, Math.PI * 2);
            ctx.fillStyle = 'rgba(0,0,0,0.3)';
            ctx.fill();

            // Corps du cœur
            ctx.beginPath();
            ctx.moveTo(x, y - size / 2);
            ctx.bezierCurveTo(x + size / 2, y - size, x + size, y - size / 2, x + size, y);
            ctx.bezierCurveTo(x + size, y + size / 2, x + size / 2, y + size / 2, x + size / 2, y + size);
            ctx.bezierCurveTo(x + size / 2, y + size / 2, x, y + size / 2, x, y + size);
            ctx.bezierCurveTo(x - size / 2, y + size / 2, x - size / 2, y + size / 2, x - size / 2, y + size);
            ctx.bezierCurveTo(x - size, y + size / 2, x - size, y, x - size, y);
            ctx.bezierCurveTo(x - size, y - size / 2, x - size / 2, y - size, x, y - size / 2);
            ctx.closePath();
            ctx.fillStyle = '#FF69B4'; // Rose vif
            ctx.fill();
            ctx.lineWidth = 4;
            ctx.strokeStyle = '#000000'; // Contours épais
            ctx.stroke();

            // Yeux mignons avec reflets
            ctx.fillStyle = '#FFFFFF';
            ctx.beginPath();
            ctx.arc(x - size / 4, y, size / 6, 0, Math.PI * 2);
            ctx.arc(x + size / 4, y, size / 6, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#000000';
            ctx.beginPath();
            ctx.arc(x - size / 4 + 2, y + 2, size / 12, 0, Math.PI * 2); // Pupilles décalées pour expression
            ctx.arc(x + size / 4 + 2, y + 2, size / 12, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#FFFFFF';
            ctx.beginPath();
            ctx.arc(x - size / 4 - 2, y - 2, size / 24, 0, Math.PI * 2); // Reflets
            ctx.arc(x + size / 4 - 2, y - 2, size / 24, 0, Math.PI * 2);
            ctx.fill();

            // Bouche souriante
            ctx.beginPath();
            ctx.arc(x, y + size / 3, size / 4, 0, Math.PI);
            ctx.lineWidth = 3;
            ctx.stroke();

            // Animation bouncy
            heartSize = 25 + Math.sin(frame / 5) * 3;
        }

        // Dessiner un tronc d'arbre en style cartoon détaillé (juste le tronc, avec texture, contours, ombre)
        function drawTree(x, y, height, width) {
            // Ombre pour profondeur
            ctx.beginPath();
            ctx.rect(x - width / 2 + 5, y + 5, width, height);
            ctx.fillStyle = 'rgba(0,0,0,0.3)';
            ctx.fill();

            // Tronc avec texture (lignes pour écorce)
            ctx.fillStyle = '#8B4513'; // Marron principal
            ctx.fillRect(x - width / 2, y, width, height);
            ctx.lineWidth = 4;
            ctx.strokeStyle = '#000000'; // Contours épais
            ctx.strokeRect(x - width / 2, y, width, height);

            // Texture écorce : lignes verticales et horizontales
            ctx.lineWidth = 2;
            ctx.strokeStyle = '#A0522D'; // Marron plus clair
            for (let i = 0; i < height / 20; i++) {
                ctx.beginPath();
                ctx.moveTo(x - width / 2 + 5, y + i * 20);
                ctx.lineTo(x + width / 2 - 5, y + i * 20 + 10);
                ctx.stroke();
            }
            ctx.strokeStyle = '#5C3317'; // Marron foncé
            for (let i = 0; i < width / 10; i++) {
                ctx.beginPath();
                ctx.moveTo(x - width / 2 + i * 10, y + 5);
                ctx.lineTo(x - width / 2 + i * 10 + 5, y + height - 5);
                ctx.stroke();
            }
        }

        // Dessiner le fond en style cartoon détaillé (petite ville plus élaborée, nuages, soleil, oiseaux, arbres lointains)
        function drawBackground() {
            // Ciel dé
